#!/bin/bash

# –°–∫—Ä–∏–ø—Ç —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è: –ú–æ–¥—É–ª—å Unlock Feature
# –î–æ–±–∞–≤–ª—è–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∫—É—Ä–∞—Ç–æ—Ä–∞–º –æ—Ç–∫—Ä—ã–≤–∞—Ç—å –º–æ–¥—É–ª–∏ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤

set -e  # –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ

echo "üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ: Module Unlock Feature"
echo "========================================"

# 1. –ü–æ–ª—É—á–∏—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è
echo ""
echo "üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏–∑ Git..."
git pull

# 2. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å backend
echo ""
echo "üî® –°–±–æ—Ä–∫–∞ backend..."
cd backend
npm run build

# 3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å backend
echo ""
echo "üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ backend..."
pm2 restart minto-backend

# 4. –ü–µ—Ä–µ—Å–æ–±—Ä–∞—Ç—å TMA
echo ""
echo "üé® –°–±–æ—Ä–∫–∞ TMA (frontend)..."
cd ../tma
npm run build

# 5. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã
echo ""
echo "‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–æ–≤..."
echo ""
echo "Backend (PM2):"
pm2 status

echo ""
echo "üéâ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!"
echo ""
echo "üìã –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:"
echo "1. –û—Ç–∫—Ä–æ–π—Ç–µ TMA –∫–∞–∫ –∫—É—Ä–∞—Ç–æ—Ä"
echo "2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ: –ö—É—Ä—Å—ã ‚Üí –ü–∏—Ä–∞–º–∏–¥–∞ –ú–∏–Ω—Ç–æ"
echo "3. –ù–∞ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö –º–æ–¥—É–ª–µ–π –ø–æ—è–≤–∏–ª–∏—Å—å –∫–Ω–æ–ø–∫–∏ 'üîì –û—Ç–∫—Ä—ã—Ç—å –¥–ª—è –≤—Å–µ—Ö'"
echo "4. –ù–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É –Ω–∞ –ª—é–±–æ–º –º–æ–¥—É–ª–µ"
echo "5. –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ"
echo "6. –ú–æ–¥—É–ª—å –æ—Ç–∫—Ä–æ–µ—Ç—Å—è –¥–ª—è –≤—Å–µ—Ö –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—á–µ–Ω–∏–∫–æ–≤"
echo ""
echo "üîì –¢–µ–ø–µ—Ä—å –∫—É—Ä–∞—Ç–æ—Ä—ã –º–æ–≥—É—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç—É–ø–æ–º –∫ –º–æ–¥—É–ª—è–º!"

