#!/bin/bash

# –¶–≤–µ—Ç–∞ –¥–ª—è –≤—ã–≤–æ–¥–∞
GREEN='\033[0;32m'
BLUE='\033[0;34m'
YELLOW='\033[1;33m'
NC='\033[0m' # No Color

echo -e "${BLUE}üöÄ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–∏–π UX —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–¥–∞–Ω–∏—è –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤${NC}"
echo "=========================================="
echo ""

# 1. Git pull
echo -e "${BLUE}üì• –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π –∏–∑ Git...${NC}"
git pull
echo ""

# 2. –°–±–æ—Ä–∫–∞ TMA
echo -e "${BLUE}üé® –°–±–æ—Ä–∫–∞ TMA (frontend)...${NC}"
cd tma
npm run build
if [ $? -ne 0 ]; then
  echo -e "${YELLOW}‚ö†Ô∏è  –û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ TMA${NC}"
  exit 1
fi
cd ..
echo ""

# 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ PM2
echo -e "${BLUE}üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤ PM2...${NC}"
pm2 status
echo ""

# 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ API
echo -e "${BLUE}üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ backend API...${NC}"
curl -I https://tma.n8nrgimprovise.space/api/auth/telegram-webapp 2>/dev/null | head -n 1
echo ""

# 5. –ü–æ—Å–ª–µ–¥–Ω–∏–µ 30 —Å—Ç—Ä–æ–∫ –ª–æ–≥–æ–≤ backend
echo -e "${BLUE}üìã –ü–æ—Å–ª–µ–¥–Ω–∏–µ –ª–æ–≥–∏ backend...${NC}"
pm2 logs minto-backend --lines 30 --nostream
echo ""

echo -e "${GREEN}‚úÖ –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!${NC}"
echo ""
echo -e "${BLUE}üìù –ß—Ç–æ –±—ã–ª–æ –æ–±–Ω–æ–≤–ª–µ–Ω–æ:${NC}"
echo "  1. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –∫–Ω–æ–ø–∫–∞ ¬´‚Üê –ù–∞–∑–∞–¥ –∫ –∑–∞–¥–∞–Ω–∏—è–º –º–æ–¥—É–ª—è¬ª –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ –∑–∞–¥–∞–Ω–∏—è"
echo "  2. ‚úÖ –°–∫—Ä—ã—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ò–ò (aiFeedback) –¥–ª—è —Ä–æ–ª–∏ LEARNER"
echo "  3. ‚úÖ –£–ª—É—á—à–µ–Ω—ã —Å—Ç–∞—Ç—É—Å—ã –æ—Ç–ø—Ä–∞–≤–∫–∏ (–∏–∫–æ–Ω–∫–∏ + –ø–æ–Ω—è—Ç–Ω—ã–µ –æ–ø–∏—Å–∞–Ω–∏—è)"
echo "  4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥—Å–∫–∞–∑–∫–∞ –¥–ª—è —É—á–µ–Ω–∏–∫–æ–≤ –ø—Ä–∏ –æ–∂–∏–¥–∞–Ω–∏–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏"
echo ""
echo -e "${BLUE}üß™ –ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:${NC}"
echo "  1. –û—Ç–∫—Ä–æ–π—Ç–µ TMA –∫–∞–∫ —É—á–µ–Ω–∏–∫ (LEARNER)"
echo "  2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –∫ –ª—é–±–æ–º—É –∑–∞–¥–∞–Ω–∏—é"
echo "  3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:"
echo "     - –ï—Å—Ç—å –∫–Ω–æ–ø–∫–∞ ¬´‚Üê –ù–∞–∑–∞–¥ –∫ –∑–∞–¥–∞–Ω–∏—è–º –º–æ–¥—É–ª—è¬ª –≤–≤–µ—Ä—Ö—É"
echo "     - –ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –ò–ò (aiFeedback)"
echo "     - –°—Ç–∞—Ç—É—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Å –∏–∫–æ–Ω–∫–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º"
echo "     - –ï—Å–ª–∏ –Ω–µ—Ç –æ—Ü–µ–Ω–∫–∏ –∫—É—Ä–∞—Ç–æ—Ä–∞ ‚Äî –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ–¥—Å–∫–∞–∑–∫–∞"
echo ""
echo -e "${YELLOW}üìñ –ü–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–∏: —Å–º. LEARNER_STEP_UX_IMPROVEMENTS.md${NC}"

