# Telegram-–±–æ—Ç ¬´–ü–∏—Ä–∞–º–∏–¥–∞ –ú–∏–Ω—Ç–æ¬ª ‚Äî –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã](#–æ–±–∑–æ—Ä-—Å–∏—Å—Ç–µ–º—ã)
2. [–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è](#–ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è)
3. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-telegram-bot)
4. [–°–æ–∑–¥–∞–Ω–∏–µ Data Tables –≤ n8n](#—Å–æ–∑–¥–∞–Ω–∏–µ-data-tables-–≤-n8n)
5. [–ò–º–ø–æ—Ä—Ç workflow](#–∏–º–ø–æ—Ä—Ç-workflow)
6. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Credentials](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-credentials)
7. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
8. [–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ](#—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ)
9. [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ workflow](#–∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞-workflow)

---

## üéØ –û–±–∑–æ—Ä —Å–∏—Å—Ç–µ–º—ã

Telegram-–±–æ—Ç –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –∫–æ–º–ø–∞–Ω–∏–∏ ¬´–ù–µ–¥–æ—Ä–æ–≥–∞—è –ú–µ–±–µ–ª—å¬ª –ø—Ä–∏–Ω—Ü–∏–ø—É –ø–∏—Ä–∞–º–∏–¥—ã –ú–∏–Ω—Ç–æ.

**–û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- **Telegram-–∫–∞–Ω–∞–ª** ‚Äî –ø—É–±–ª–∏–∫–∞—Ü–∏—è –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤
- **Telegram-–±–æ—Ç** ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞–Ω–∏–π, —Ç–µ—Å—Ç—ã, —Å–¥–∞—á–∏, –æ—Ü–µ–Ω–∫–∏
- **n8n** ‚Äî –æ—Ä–∫–µ—Å—Ç—Ä–∞—Ç–æ—Ä –ª–æ–≥–∏–∫–∏ (FSM/Router)
- **Data Tables** ‚Äî —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∏ —Å–¥–∞—á
- **OpenAI** ‚Äî –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–¥–∞–Ω–∏–π

**–†–æ–ª–∏:**
- **–û–±—É—á–∞—é—â–∏–π—Å—è (learner)** ‚Äî –ø—Ä–æ—Ö–æ–¥–∏—Ç –º–æ–¥—É–ª–∏, –≤—ã–ø–æ–ª–Ω—è–µ—Ç –∑–∞–¥–∞–Ω–∏—è
- **–ö—É—Ä–∞—Ç–æ—Ä (curator)** ‚Äî –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥—É–ª—è–º, –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ä–∞–±–æ—Ç—ã, –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è

---

## üì¶ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **n8n** –≤–µ—Ä—Å–∏–∏ 1.115.3 –∏–ª–∏ –≤—ã—à–µ
2. **Telegram Bot Token** (–ø–æ–ª—É—á–∏—Ç—å —É [@BotFather](https://t.me/BotFather))
3. **OpenAI API Key** (–¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–¥–∞–Ω–∏–π)
4. –î–æ—Å—Ç—É–ø –∫ n8n —Å –ø—Ä–∞–≤–∞–º–∏ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ workflows –∏ Data Tables

---

## ü§ñ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram Bot

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –°–ª–µ–¥—É–π—Ç–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º:
   - –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `–ú–∏–Ω—Ç–æ –ë–æ—Ç`)
   - –í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä: `minto_education_bot`)
4. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ **Bot Token** (—Ñ–æ—Ä–º–∞—Ç: `123456789:ABCdefGHIjklMNOpqrsTUVwxyz`)

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–º–∞–Ω–¥ –±–æ—Ç–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–û—Ç–ø—Ä–∞–≤—å—Ç–µ BotFather –∫–æ–º–∞–Ω–¥—É:
```
/setcommands
```

–í—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞ –∏ –≤–≤–µ–¥–∏—Ç–µ:
```
start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
menu - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
progress - –ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å
```

---

## üóÑÔ∏è –°–æ–∑–¥–∞–Ω–∏–µ Data Tables –≤ n8n

### –¢–∞–±–ª–∏—Ü–∞ 1: `learners`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏—Ç –ø—Ä–æ—Ñ–∏–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤ –∫—É—Ä—Å–µ.

**–°–æ–∑–¥–∞–Ω–∏–µ:**
1. –í n8n –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Data Tables**
2. –ù–∞–∂–º–∏—Ç–µ **Create Data Table**
3. –ù–∞–∑–≤–∞–Ω–∏–µ: `learners`
4. –î–æ–±–∞–≤—å—Ç–µ —Å–ª–µ–¥—É—é—â–∏–µ –ø–æ–ª—è:

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `tg_id` | String | ‚úÖ | Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—É–Ω–∏–∫–∞–ª—å–Ω—ã–π) |
| `first_name` | String | ‚úÖ | –ò–º—è |
| `last_name` | String | ‚úÖ | –§–∞–º–∏–ª–∏—è |
| `position` | String | ‚úÖ | –î–æ–ª–∂–Ω–æ—Å—Ç—å |
| `role` | String | ‚úÖ | `learner` –∏–ª–∏ `curator` |
| `state` | String | ‚úÖ | –¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ FSM |
| `current_module` | Number | ‚úÖ | –¢–µ–∫—É—â–∏–π –º–æ–¥—É–ª—å (1-3 –∏–ª–∏ 4 –¥–ª—è —ç–∫–∑–∞–º–µ–Ω–∞) |
| `current_step` | Number | ‚úÖ | –¢–µ–∫—É—â–∏–π —à–∞–≥ –≤–Ω—É—Ç—Ä–∏ –º–æ–¥—É–ª—è |
| `module1_done` | Boolean | ‚úÖ | –ú–æ–¥—É–ª—å 1 –∑–∞–≤–µ—Ä—à–µ–Ω |
| `module2_done` | Boolean | ‚úÖ | –ú–æ–¥—É–ª—å 2 –∑–∞–≤–µ—Ä—à–µ–Ω |
| `module3_done` | Boolean | ‚úÖ | –ú–æ–¥—É–ª—å 3 –∑–∞–≤–µ—Ä—à–µ–Ω |
| `exam_done` | Boolean | ‚úÖ | –≠–∫–∑–∞–º–µ–Ω –∑–∞–≤–µ—Ä—à–µ–Ω |
| `module2_unlocked` | Boolean | ‚úÖ | –î–æ—Å—Ç—É–ø –∫ –º–æ–¥—É–ª—é 2 –æ—Ç–∫—Ä—ã—Ç |
| `module3_unlocked` | Boolean | ‚úÖ | –î–æ—Å—Ç—É–ø –∫ –º–æ–¥—É–ª—é 3 –æ—Ç–∫—Ä—ã—Ç |
| `exam_unlocked` | Boolean | ‚úÖ | –î–æ—Å—Ç—É–ø –∫ —ç–∫–∑–∞–º–µ–Ω—É –æ—Ç–∫—Ä—ã—Ç |
| `last_answer_text` | String | ‚ùå | –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–≤–µ—Ç (—Ç–µ–∫—Å—Ç) |
| `last_answer_file` | String | ‚ùå | –ü–æ—Å–ª–µ–¥–Ω–∏–π –æ—Ç–≤–µ—Ç (file_id) |
| `last_activity_at` | DateTime | ‚úÖ | –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ |

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã —Å–∫–æ–ø–∏—Ä—É–π—Ç–µ **Data Table ID** ‚Äî –æ–Ω –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ workflow.

### –¢–∞–±–ª–∏—Ü–∞ 2: `submissions`

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏—Ç –≤—Å–µ —Å–¥–∞—á–∏ –∑–∞–¥–∞–Ω–∏–π –æ–±—É—á–∞—é—â–∏—Ö—Å—è.

**–°–æ–∑–¥–∞–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—É—é Data Table: `submissions`
2. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—è:

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `id` | Number | ‚úÖ | –ê–≤—Ç–æ–∏–Ω–∫—Ä–µ–º–µ–Ω—Ç (Primary Key) |
| `tg_id` | String | ‚úÖ | Telegram ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `module` | Number | ‚úÖ | –ù–æ–º–µ—Ä –º–æ–¥—É–ª—è (1-3 –∏–ª–∏ 4) |
| `step` | Number | ‚úÖ | –ù–æ–º–µ—Ä —à–∞–≥–∞ |
| `answer_text` | String | ‚ùå | –¢–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ |
| `answer_file` | String | ‚ùå | File ID (–¥–ª—è –∞—É–¥–∏–æ/–≤–∏–¥–µ–æ) |
| `ai_feedback` | String | ‚ùå | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –æ—Ç –ò–ò |
| `ai_score` | Number | ‚ùå | –û—Ü–µ–Ω–∫–∞ –æ—Ç –ò–ò (0-10) |
| `curator_feedback` | String | ‚ùå | –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∫—É—Ä–∞—Ç–æ—Ä–∞ |
| `curator_score` | Number | ‚ùå | –û—Ü–µ–Ω–∫–∞ –∫—É—Ä–∞—Ç–æ—Ä–∞ |
| `status` | String | ‚úÖ | `new`, `ai_reviewed`, `curator_approved`, `curator_returned` |
| `created_at` | DateTime | ‚úÖ | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è |

### –¢–∞–±–ª–∏—Ü–∞ 3: `course_structure` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –•—Ä–∞–Ω–∏—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –∫—É—Ä—Å–∞ (–º–æ–¥—É–ª–∏, —à–∞–≥–∏, –∑–∞–¥–∞–Ω–∏—è).

**–°–æ–∑–¥–∞–Ω–∏–µ:**
1. –°–æ–∑–¥–∞–π—Ç–µ Data Table: `course_structure`
2. –î–æ–±–∞–≤—å—Ç–µ –ø–æ–ª—è:

| –ü–æ–ª–µ | –¢–∏–ø | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|-----|--------------|----------|
| `module` | Number | ‚úÖ | –ù–æ–º–µ—Ä –º–æ–¥—É–ª—è |
| `step` | Number | ‚úÖ | –ù–æ–º–µ—Ä —à–∞–≥–∞ |
| `type` | String | ‚úÖ | `info`, `task`, `quiz`, `exam` |
| `title` | String | ‚úÖ | –ó–∞–≥–æ–ª–æ–≤–æ–∫ |
| `text` | String | ‚úÖ | –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è |
| `requires_ai` | Boolean | ‚úÖ | –¢—Ä–µ–±—É–µ—Ç—Å—è –ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ò–ò |

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ workflow —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π –∑–∞—à–∏—Ç–∞ –≤ –∫–æ–¥. –¢–∞–±–ª–∏—Ü–∞ `course_structure` –º–æ–∂–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –¥–ª—è –±—É–¥—É—â–∏—Ö —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π.

---

## üì• –ò–º–ø–æ—Ä—Ç workflow

### –®–∞–≥ 1: –ò–º–ø–æ—Ä—Ç JSON

1. –û—Ç–∫—Ä–æ–π—Ç–µ n8n
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª **Workflows**
3. –ù–∞–∂–º–∏—Ç–µ **Import from File**
4. –í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª `MintoCourseLearnerBot_v2.json`
5. –ù–∞–∂–º–∏—Ç–µ **Import**

### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Data Table ID

–ü–æ—Å–ª–µ –∏–º–ø–æ—Ä—Ç–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –æ–±–Ω–æ–≤–∏—Ç—å ID —Ç–∞–±–ª–∏—Ü –≤–æ –≤—Å–µ—Ö —É–∑–ª–∞—Ö `Data Table`:

1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow
2. –ù–∞–π–¥–∏—Ç–µ –≤—Å–µ —É–∑–ª—ã —Ç–∏–ø–∞ **Data Table**
3. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞:
   - –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ —É–∑–µ–ª
   - –í –ø–æ–ª–µ **Data Table** –≤—ã–±–µ—Ä–∏—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â—É—é —Ç–∞–±–ª–∏—Ü—É:
     - `learners` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `learners`
     - `submissions` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `submissions`
     - `course_structure` ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ —Ç–∞–±–ª–∏—Ü—É `course_structure` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è)

**–°–ø–∏—Å–æ–∫ —É–∑–ª–æ–≤ –¥–ª—è –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:**
- `Get User from Learners`
- `Create New User`
- `Update: Save Name`
- `Update: Save Lastname`
- `Update: Save Position & Complete Registration`
- `Update Step Progress`
- `Update State: Waiting Answer`
- `Save Answer (Temp)`
- `Create Submission`
- `Update Submission: AI Review`
- `Get Curators`
- `Update After Submission`
- `Update Curator State: Menu`
- `Unlock Module 2: All`
- `Mark Module 1 Done`

---

## üîê –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Credentials

### Telegram API

1. –í n8n –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Credentials**
2. –ù–∞–∂–º–∏—Ç–µ **Add Credential**
3. –í—ã–±–µ—Ä–∏—Ç–µ **Telegram**
4. –í–≤–µ–¥–∏—Ç–µ:
   - **Access Token:** –≤–∞—à Bot Token –æ—Ç BotFather
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `Telegram API`

### OpenAI API

1. –í **Credentials** –≤—ã–±–µ—Ä–∏—Ç–µ **OpenAI**
2. –í–≤–µ–¥–∏—Ç–µ:
   - **API Key:** –≤–∞—à OpenAI API –∫–ª—é—á
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –∫–∞–∫ `OpenAI API`

### –ü—Ä–∏–≤—è–∑–∫–∞ Credentials –∫ —É–∑–ª–∞–º

1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow
2. –î–ª—è –∫–∞–∂–¥–æ–≥–æ —É–∑–ª–∞ **Telegram**:
   - –í—ã–±–µ—Ä–∏—Ç–µ credential `Telegram API`
3. –î–ª—è —É–∑–ª–∞ **OpenAI: Review Submission**:
   - –í—ã–±–µ—Ä–∏—Ç–µ credential `OpenAI API`

---

## üåç –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

–ï—Å–ª–∏ –≤—ã –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è API –∫–ª—é—á–µ–π:

1. –í n8n –ø–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Settings** ‚Üí **Environment Variables**
2. –î–æ–±–∞–≤—å—Ç–µ:
   - `TELEGRAM_BOT_TOKEN` ‚Äî —Ç–æ–∫–µ–Ω –±–æ—Ç–∞
   - `OPENAI_API_KEY` ‚Äî –∫–ª—é—á OpenAI

3. –í —É–∑–ª–∞—Ö –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—ã—Ä–∞–∂–µ–Ω–∏—è:
   - `{{ $env.TELEGRAM_BOT_TOKEN }}`
   - `{{ $env.OPENAI_API_KEY }}`

---

## ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –®–∞–≥ 1: –ê–∫—Ç–∏–≤–∞—Ü–∏—è workflow

1. –û—Ç–∫—Ä–æ–π—Ç–µ workflow –≤ n8n
2. –ù–∞–∂–º–∏—Ç–µ **Active** (–ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É)
3. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ workflow –∞–∫—Ç–∏–≤–µ–Ω

### –®–∞–≥ 2: –¢–µ—Å—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à–µ–≥–æ –±–æ—Ç–∞
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start` –∏–ª–∏ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
3. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–ø—Ä–æ—Å–∏—Ç—å –≤–≤–µ—Å—Ç–∏ –∏–º—è
4. –í–≤–µ–¥–∏—Ç–µ –∏–º—è ‚Üí —Ñ–∞–º–∏–ª–∏—é ‚Üí –¥–æ–ª–∂–Ω–æ—Å—Ç—å
5. –ü–æ—Å–ª–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é

### –®–∞–≥ 3: –¢–µ—Å—Ç –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –º–æ–¥—É–ª—è

1. –ù–∞–∂–º–∏—Ç–µ **‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ**
2. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –≤–≤–æ–¥–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ú–æ–¥—É–ª–µ 1
3. –ù–∞–∂–º–∏—Ç–µ **‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å**
4. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–∫–∞–∑–∞—Ç—å –ø–µ—Ä–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ
5. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –æ—Ç–≤–µ—Ç (—Ç–µ–∫—Å—Ç –∏–ª–∏ —Ñ–∞–π–ª)
6. –ù–∞–∂–º–∏—Ç–µ **‚úÖ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç**
7. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫—É –ò–ò

### –®–∞–≥ 4: –¢–µ—Å—Ç –∫—É—Ä–∞—Ç–æ—Ä–∞

1. –í —Ç–∞–±–ª–∏—Ü–µ `learners` –Ω–∞–π–¥–∏—Ç–µ –≤–∞—à—É –∑–∞–ø–∏—Å—å
2. –ò–∑–º–µ–Ω–∏—Ç–µ –ø–æ–ª–µ `role` –Ω–∞ `curator`
3. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –±–æ—Ç—É –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
4. –î–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è –º–µ–Ω—é –∫—É—Ä–∞—Ç–æ—Ä–∞

### –®–∞–≥ 5: –¢–µ—Å—Ç –æ—Ç–∫—Ä—ã—Ç–∏—è –º–æ–¥—É–ª—è

1. –ö–∞–∫ –∫—É—Ä–∞—Ç–æ—Ä, –Ω–∞–∂–º–∏—Ç–µ **üîì –û—Ç–∫—Ä—ã—Ç—å –º–æ–¥—É–ª—å**
2. –í—ã–±–µ—Ä–∏—Ç–µ **–ú–æ–¥—É–ª—å 2**
3. –í—ã–±–µ—Ä–∏—Ç–µ **‚úÖ –û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ–º**
4. –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –ø–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å –æ—Ç–∫—Ä—ã—Ç–∏–µ

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ workflow

### –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫ (FSM Router)

```
Telegram Trigger
  ‚Üì
Extract User Data (–∏–∑–≤–ª–µ—á–µ–Ω–∏–µ tg_id, message_text, callback_data)
  ‚Üì
Get User from Learners (–ø–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–∑ –ë–î)
  ‚Üì
User Exists? (IF)
  ‚îú‚îÄ –î–∞ ‚Üí Prepare User Context
  ‚îî‚îÄ –ù–µ—Ç ‚Üí Create New User ‚Üí Prepare User Context
  ‚Üì
Switch by Role (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ä–æ–ª–∏)
  ‚îú‚îÄ curator ‚Üí Switch Curator State
  ‚îî‚îÄ learner ‚Üí Switch Learner State
```

### –ü–æ—Ç–æ–∫ –¥–ª—è –æ–±—É—á–∞—é—â–µ–≥–æ—Å—è (learner)

```
Switch Learner State
  ‚îú‚îÄ registration_waiting_name ‚Üí Registration: Ask Name
  ‚îú‚îÄ registration_waiting_lastname ‚Üí Registration: Ask Lastname
  ‚îú‚îÄ registration_waiting_position ‚Üí Registration: Ask Position
  ‚îú‚îÄ idle ‚Üí Switch: Idle Menu
  ‚îÇ   ‚îú‚îÄ ‚ñ∂Ô∏è –ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å –æ–±—É—á–µ–Ω–∏–µ ‚Üí Prepare Module Content
  ‚îÇ   ‚îú‚îÄ üìö –ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å ‚Üí (–ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å)
  ‚îÇ   ‚îî‚îÄ üìé –ú–æ–∏ —Å–¥–∞—á–∏ ‚Üí (–ø–æ–∫–∞–∑–∞—Ç—å —Å–¥–∞—á–∏)
  ‚îú‚îÄ m1_waiting_answer_s* ‚Üí Switch: Waiting Answer States
  ‚îÇ   ‚îî‚îÄ Extract Answer ‚Üí Save Answer (Temp) ‚Üí Confirm Answer Saved
  ‚îî‚îÄ m1_finished_wait_unlock ‚Üí Module Complete
```

### –ü–æ—Ç–æ–∫ —Å–¥–∞—á–∏ –∑–∞–¥–∞–Ω–∏—è

```
Check: Submit Callback (IF callback_data = "submit_answer")
  ‚Üì
Create Submission (—Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–ø–∏—Å–∏ –≤ submissions)
  ‚Üì
OpenAI: Review Submission (–ø—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ –ò–ò)
  ‚Üì
Parse AI Response (–ø–∞—Ä—Å–∏–Ω–≥ –æ—Ç–≤–µ—Ç–∞ –ò–ò)
  ‚Üì
Update Submission: AI Review (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ü–µ–Ω–∫–∏)
  ‚Üì
Get Curators (–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫—É—Ä–∞—Ç–æ—Ä–æ–≤)
  ‚Üì
Notify Curator (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –∫—É—Ä–∞—Ç–æ—Ä–∞)
  ‚Üì
Notify Learner: Submitted (—É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–±—É—á–∞—é—â–µ–≥–æ—Å—è)
  ‚Üì
Update After Submission (–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è)
```

### –ü–æ—Ç–æ–∫ –¥–ª—è –∫—É—Ä–∞—Ç–æ—Ä–∞

```
Switch Curator State
  ‚îú‚îÄ curator_menu ‚Üí Curator Menu
  ‚îÇ   ‚îî‚îÄ Update Curator State: Menu
  ‚îî‚îÄ curator_unlock_module ‚Üí Curator: Unlock Menu
      ‚îî‚îÄ Curator: Unlock Options
          ‚îî‚îÄ Unlock Module 2: All
              ‚îî‚îÄ Confirm Unlock
```

---

## üîß –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –Ω–µ–ø–æ–ª–∞–¥–æ–∫

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ workflow **–∞–∫—Ç–∏–≤–µ–Ω** –≤ n8n
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **Telegram credentials** (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ —Ç–æ–∫–µ–Ω)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤ n8n (Execution Log)

### –û—à–∏–±–∫–∞ "Data Table not found"

1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤–æ –≤—Å–µ—Ö —É–∑–ª–∞—Ö **Data Table** –≤—ã–±—Ä–∞–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Ç–∞–±–ª–∏—Ü–∞–º

### –û—à–∏–±–∫–∞ OpenAI

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ **OpenAI credentials** (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –ª–∏ API –∫–ª—é—á)
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –±–∞–ª–∞–Ω—Å –Ω–∞ —Å—á–µ—Ç—É OpenAI
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–∏–º–∏—Ç—ã API

### –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —Å–æ–∑–¥–∞–µ—Ç—Å—è

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ç–∞–±–ª–∏—Ü—ã `learners`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª–µ `tg_id` –∏–º–µ–µ—Ç —Ç–∏–ø String
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflow

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫—É—Ä–∞—Ç–æ—Ä–∞ –≤—Ä—É—á–Ω—É—é

1. –û—Ç–∫—Ä–æ–π—Ç–µ —Ç–∞–±–ª–∏—Ü—É `learners` –≤ n8n
2. –ù–∞–π–¥–∏—Ç–µ –∏–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –∑–∞–ø–∏—Å—å —Å –Ω—É–∂–Ω—ã–º `tg_id`
3. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:
   - `role` = `curator`
   - `state` = `curator_menu`

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –º–æ–¥—É–ª–µ–π

–í —Ç–µ–∫—É—â–µ–π –≤–µ—Ä—Å–∏–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–¥—É–ª–µ–π –∑–∞—à–∏—Ç–∞ –≤ —É–∑–ª–µ **Prepare Module Content** (Code node). –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —É–∑–µ–ª **Prepare Module Content**
2. –ò–∑–º–µ–Ω–∏—Ç–µ –º–∞—Å—Å–∏–≤ `module1Steps` (–∏–ª–∏ –¥–æ–±–∞–≤—å—Ç–µ `module2Steps`, `module3Steps`)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ workflow

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `course_structure` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –∫—É—Ä—Å–∞.

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø—Ä–æ–º–ø—Ç–∞ –¥–ª—è OpenAI

–ü—Ä–æ–º–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–¥–∞–Ω–∏–π –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —É–∑–ª–µ **OpenAI: Review Submission**. –î–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. –û—Ç–∫—Ä–æ–π—Ç–µ —É–∑–µ–ª **OpenAI: Review Submission**
2. –ò–∑–º–µ–Ω–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è (System message)
3. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ workflow

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è n8n](https://docs.n8n.io/)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Telegram Bot API](https://core.telegram.org/bots/api)
- [–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è OpenAI API](https://platform.openai.com/docs)
- [–°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è –±–æ—Ç–∞](./full_minto_bot_spec.md)

---

## üÜò –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –ø—Ä–æ–±–ª–µ–º:

1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è workflow –≤ n8n
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ credentials –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É Data Tables
4. –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ `full_minto_bot_spec.md`

---

**–í–µ—Ä—Å–∏—è:** 2.0  
**–î–∞—Ç–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:** 2024  
**–ê–≤—Ç–æ—Ä:** n8n Workflow –¥–ª—è –∫—É—Ä—Å–∞ ¬´–ü–∏—Ä–∞–º–∏–¥–∞ –ú–∏–Ω—Ç–æ¬ª

