# –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫—É—Ä—Å–æ–≤ –Ω–∞ backend

## –û–±–∑–æ—Ä –∏–∑–º–µ–Ω–µ–Ω–∏–π

–î–æ–±–∞–≤–ª–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ –∫—É—Ä—Å—É –Ω–∞ backend, —á—Ç–æ–±—ã TMA –Ω–µ —Å—á–∏—Ç–∞–ª –µ—ë –≤—Ä—É—á–Ω—É—é.

### –ù–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç:

**`GET /admin/course/modules/:id/stats`**

**–î–æ—Å—Ç—É–ø:** CURATOR, ADMIN

**–û—Ç–≤–µ—Ç:**
```json
{
  "moduleId": "uuid",
  "totalLearners": 5,
  "inProgressLearners": 2,
  "completedLearners": 3,
  "submissionsTotal": 18,
  "submissionsOnReview": 4
}
```

---

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ backend

### 1. CourseAdminService

**–§–∞–π–ª:** `backend/src/course/course-admin.service.ts`

**–ù–æ–≤—ã–π –º–µ—Ç–æ–¥:** `getModuleStats(moduleId: string)`

**–õ–æ–≥–∏–∫–∞:**
- –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Å–µ `Enrollment` –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è
- –°—á–∏—Ç–∞–µ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º (IN_PROGRESS, COMPLETED)
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Å–µ `Submission` –¥–ª—è —ç—Ç–æ–≥–æ –º–æ–¥—É–ª—è
- –°—á–∏—Ç–∞–µ—Ç –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–∞—á –∏ —Å–¥–∞—á –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ (SENT, AI_REVIEWED)

```typescript
async getModuleStats(moduleId: string) {
  // 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–æ–¥—É–ª—è
  const module = await this.prisma.courseModule.findUnique({
    where: { id: moduleId },
  });

  // 2. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ enrollments
  const enrollments = await this.prisma.enrollment.findMany({
    where: { moduleId },
    select: { status: true },
  });

  // 3. –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ submissions
  const submissions = await this.prisma.submission.findMany({
    where: { moduleId },
    select: { status: true },
  });

  // 4. –í–æ–∑–≤—Ä–∞—Ç –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
  return {
    moduleId,
    totalLearners: enrollments.length,
    inProgressLearners: enrollments.filter(e => e.status === 'IN_PROGRESS').length,
    completedLearners: enrollments.filter(e => e.status === 'COMPLETED').length,
    submissionsTotal: submissions.length,
    submissionsOnReview: submissions.filter(s => s.status === 'SENT' || s.status === 'AI_REVIEWED').length,
  };
}
```

---

### 2. CourseBuilderController

**–§–∞–π–ª:** `backend/src/course/course-builder.controller.ts`

**–ù–æ–≤—ã–π —ç–Ω–¥–ø–æ–∏–Ω—Ç:**

```typescript
@Get('modules/:id/stats')
@Roles(UserRole.ADMIN, UserRole.CURATOR)
async getModuleStats(@Param('id') id: string) {
  return this.courseAdminService.getModuleStats(id);
}
```

**–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**

–°–ª–µ–¥—É—é—â–∏–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã —Ç–µ–ø–µ—Ä—å –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è **CURATOR + ADMIN** (—Ä–∞–Ω—å—à–µ —Ç–æ–ª—å–∫–æ ADMIN):

- `GET /admin/course/modules` ‚Äî —Å–ø–∏—Å–æ–∫ –º–æ–¥—É–ª–µ–π
- `GET /admin/course/modules/:id` ‚Äî –¥–µ—Ç–∞–ª–∏ –º–æ–¥—É–ª—è
- `GET /admin/course/modules/:id/stats` ‚Äî —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–æ–¥—É–ª—è (–Ω–æ–≤—ã–π)
- `GET /admin/course/modules/:moduleId/steps` ‚Äî —Å–ø–∏—Å–æ–∫ —à–∞–≥–æ–≤ –º–æ–¥—É–ª—è

**–¢–æ–ª—å–∫–æ ADMIN:**
- `POST /admin/course/modules` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥—É–ª—è
- `PATCH /admin/course/modules/:id` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –º–æ–¥—É–ª—è
- `DELETE /admin/course/modules/:id` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ –º–æ–¥—É–ª—è
- `POST /admin/course/steps` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ —à–∞–≥–∞
- `PATCH /admin/course/steps/:id` ‚Äî —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —à–∞–≥–∞
- `DELETE /admin/course/steps/:id` ‚Äî —É–¥–∞–ª–µ–Ω–∏–µ —à–∞–≥–∞

---

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –≤ TMA

### CourseDashboardPage

**–§–∞–π–ª:** `tma/src/pages/curator/CourseDashboardPage.tsx`

**–ë—ã–ª–æ:**
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–ª `/admin/learners`
- –í—Ä—É—á–Ω—É—é —Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–ª enrollments –ø–æ `moduleId`
- –°—á–∏—Ç–∞–ª —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ

**–°—Ç–∞–ª–æ:**
- –ó–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç `/admin/course/modules/:id/stats`
- –ü–æ–ª—É—á–∞–µ—Ç –≥–æ—Ç–æ–≤—É—é —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É —Å backend
- –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—É—é –∫–∞—Ä—Ç–æ—á–∫—É "–°–¥–∞—á–∏"

**–ù–æ–≤–∞—è 4-—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìã          ‚îÇ
‚îÇ 18          ‚îÇ
‚îÇ –°–¥–∞—á–∏       ‚îÇ
‚îÇ 4 –Ω–∞ –ø—Ä–æ–≤–µ—Ä.‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ –Ω–∞ VPS

### –®–∞–≥ 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ

```bash
ssh root@79.132.140.13
```

### –®–∞–≥ 2: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞

```bash
cd /var/www/tma_education
git pull
```

### –®–∞–≥ 3: –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ backend

```bash
cd /var/www/tma_education/backend
npm run build
pm2 restart minto-backend
```

### –®–∞–≥ 4: –ü–µ—Ä–µ—Å–±–æ—Ä–∫–∞ TMA

```bash
cd /var/www/tma_education/tma
npm run build
```

### –®–∞–≥ 5: –ü—Ä–æ–≤–µ—Ä–∫–∞

```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å –ø—Ä–æ—Ü–µ—Å—Å–æ–≤
pm2 status

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ backend
pm2 logs minto-backend --lines 50

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ backend –æ—Ç–≤–µ—á–∞–µ—Ç
curl -I https://tma.n8nrgimprovise.space/api/course/modules
```

---

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

### 1. –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –∫—É—Ä–∞—Ç–æ—Ä

–û—Ç–∫—Ä–æ–π—Ç–µ –±–æ—Ç–∞ –≤ Telegram –æ—Ç –∞–∫–∫–∞—É–Ω—Ç–∞ –∫—É—Ä–∞—Ç–æ—Ä–∞:
- –†–æ—Å—Ç–∏—Å–ª–∞–≤ (7017219152)
- –≠–¥—É–∞—Ä–¥ (447493564)

### 2. –û—Ç–∫—Ä—ã—Ç—å –¥–∞—à–±–æ—Ä–¥ –∫—É—Ä—Å–æ–≤

1. –ù–∞–∂–º–∏—Ç–µ "–û—Ç–∫—Ä—ã—Ç—å —É—á–µ–±–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ"
2. –î–æ–ª–∂–Ω–∞ –æ—Ç–∫—Ä—ã—Ç—å—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/curator/courses`
3. –í–∏–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ –∫—É—Ä—Å–æ–≤

### 3. –û—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π –¥–∞—à–±–æ—Ä–¥ –∫—É—Ä—Å–∞

1. –ö–ª–∏–∫–Ω–∏—Ç–µ –Ω–∞ –ª—é–±—É—é –∫–∞—Ä—Ç–æ—á–∫—É –∫—É—Ä—Å–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–ú–æ–¥—É–ª—å 1")
2. –û—Ç–∫—Ä–æ–µ—Ç—Å—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ `/curator/courses/:moduleId`
3. –î–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å **4 –∫–∞—Ä—Ç–æ—á–∫–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏:**

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ üìù          ‚îÇ ‚îÇ üë•          ‚îÇ ‚îÇ üìä          ‚îÇ ‚îÇ üìã          ‚îÇ
‚îÇ 6           ‚îÇ ‚îÇ 5           ‚îÇ ‚îÇ 60%         ‚îÇ ‚îÇ 18          ‚îÇ
‚îÇ –í—Å–µ–≥–æ —à–∞–≥–æ–≤ ‚îÇ ‚îÇ –£—á–∞—Å—Ç–Ω–∏–∫–æ–≤  ‚îÇ ‚îÇ –ü—Ä–æ–≥—Ä–µ—Å—Å    ‚îÇ ‚îÇ –°–¥–∞—á–∏       ‚îÇ
‚îÇ 5 –æ–±—è–∑–∞—Ç.   ‚îÇ ‚îÇ 2 –≤ –ø—Ä–æ—Ü–µ—Å—Å–µ‚îÇ ‚îÇ % –∑–∞–≤–µ—Ä—à–∏–ª–∏ ‚îÇ ‚îÇ 4 –Ω–∞ –ø—Ä–æ–≤–µ—Ä.‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –¥–∞–Ω–Ω—ã–µ

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ:
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Å–æ–≤–ø–∞–¥–∞–µ—Ç —Å —Ä–µ–∞–ª—å–Ω—ã–º
- –ü—Ä–æ–≥—Ä–µ—Å—Å –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–¥–∞—á –∏ —Å–¥–∞—á –Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

---

## API —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç —ç–Ω–¥–ø–æ–∏–Ω—Ç–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

```bash
# –ü–æ–ª—É—á–∏—Ç—å JWT —Ç–æ–∫–µ–Ω (–∑–∞–º–µ–Ω–∏—Ç–µ –Ω–∞ —Ä–µ–∞–ª—å–Ω—ã–π –∏–∑ –±—Ä–∞—É–∑–µ—Ä–∞)
TOKEN="your-jwt-token-here"

# –ó–∞–ø—Ä–æ—Å–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –ø–æ –º–æ–¥—É–ª—é
curl -X GET \
  "https://tma.n8nrgimprovise.space/api/admin/course/modules/MODULE_ID/stats" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json"
```

**–û–∂–∏–¥–∞–µ–º—ã–π –æ—Ç–≤–µ—Ç:**

```json
{
  "moduleId": "cm4dxxxx...",
  "totalLearners": 5,
  "inProgressLearners": 2,
  "completedLearners": 3,
  "submissionsTotal": 18,
  "submissionsOnReview": 4
}
```

---

## –û—Ç–∫–∞—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π (–µ—Å–ª–∏ —á—Ç–æ-—Ç–æ –ø–æ—à–ª–æ –Ω–µ —Ç–∞–∫)

### –û—Ç–∫–∞—Ç–∏—Ç—å backend

```bash
cd /var/www/tma_education
git log --oneline -5  # –ù–∞–π—Ç–∏ —Ö–µ—à –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∫–æ–º–º–∏—Ç–∞
git checkout <previous-commit-hash>
cd backend
npm run build
pm2 restart minto-backend
```

### –û—Ç–∫–∞—Ç–∏—Ç—å TMA

```bash
cd /var/www/tma_education/tma
npm run build
```

### –í–µ—Ä–Ω—É—Ç—å –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –∫–æ–º–º–∏—Ç

```bash
cd /var/www/tma_education
git checkout main
git pull
```

---

## Troubleshooting

### –û—à–∏–±–∫–∞: "Module not found"

**–ü—Ä–∏—á–∏–Ω–∞:** –ú–æ–¥—É–ª—å —Å —É–∫–∞–∑–∞–Ω–Ω—ã–º ID –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –º–æ–¥—É–ª—å —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –≤ –ë–î:
   ```sql
   SELECT id, title FROM "CourseModule";
   ```
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π ID –º–æ–¥—É–ª—è

---

### –û—à–∏–±–∫–∞: "Unauthorized"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ—Ç –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞ (–Ω–µ CURATOR/ADMIN)

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ä–æ–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   ```sql
   SELECT "telegramId", role FROM "User" WHERE "telegramId" = '7017219152';
   ```
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω

---

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ

**–†–µ—à–µ–Ω–∏–µ:**
1. –û–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É (F5 –∏–ª–∏ Ctrl+R)
2. –û—á–∏—Å—Ç–∏—Ç–µ –∫—ç—à –±—Ä–∞—É–∑–µ—Ä–∞
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ backend –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

---

## –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤

–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ—Ç:
- 1 –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–æ–¥—É–ª—è
- 1 –∑–∞–ø—Ä–æ—Å –¥–ª—è enrollments (—Ç–æ–ª—å–∫–æ –ø–æ–ª–µ status)
- 1 –∑–∞–ø—Ä–æ—Å –¥–ª—è submissions (—Ç–æ–ª—å–∫–æ –ø–æ–ª–µ status)

**–ò—Ç–æ–≥–æ:** 3 –∑–∞–ø—Ä–æ—Å–∞ –∫ –ë–î –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

### –í–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ï—Å–ª–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–∞—á–Ω—ë—Ç —Ç–æ—Ä–º–æ–∑–∏—Ç—å –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤:

1. **–î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã:**
   ```sql
   CREATE INDEX idx_enrollment_moduleid_status ON "Enrollment"("moduleId", "status");
   CREATE INDEX idx_submission_moduleid_status ON "Submission"("moduleId", "status");
   ```

2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Prisma aggregate:**
   ```typescript
   const stats = await this.prisma.enrollment.groupBy({
     by: ['status'],
     where: { moduleId },
     _count: { status: true },
   });
   ```

3. **–ö—ç—à–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã (Redis):**
   - TTL: 5-10 –º–∏–Ω—É—Ç
   - –ò–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ Enrollment/Submission

---

**–í–µ—Ä—Å–∏—è:** 3.1  
**–î–∞—Ç–∞:** 2025-11-29  
**–ò–∑–º–µ–Ω–µ–Ω–∏—è:** –≠–Ω–¥–ø–æ–∏–Ω—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –∫—É—Ä—Å–∞, –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ RBAC, 4-—è –∫–∞—Ä—Ç–æ—á–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤ TMA

